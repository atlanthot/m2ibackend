<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>Chat</title>
		<script src="node_modules/socket.io/node_modules/socket.io-client/socket.io.js"></script>
		<script type="text/javascript">
		
			var socket = null;
			
			function sendMessage()
			{
				var mon_champ = document.getElementById("user_message");
				var message = mon_champ.value;
				
				socket.emit('message_from_client', message);
				
				mon_champ.value = "";
			}
			
			function connectSucces(data)
			{
				var mon_bouton = document.getElementById('send_btn');
				mon_bouton.addEventListener('click', sendMessage );
			}
			
			// data ici vaut le tableau qui contient l'ensemble des messages 
			// envoyés par l'ensemble des clients connectés au serveur
			function messagesHandler(data)
			{
				var i = 0;
				var max = data.length;
				var html = "";
				var container = document.getElementById("messages");
				
				for( i = 0; i < max; i++ )
				{
					html += "<p>"+data[i]+"</p>";
				}
				
				container.innerHTML = html;
				
			}
			
			window.onload = function()
			{
				socket = io.connect('127.0.0.1:3000');
				socket.on('connection_ok', connectSucces );
				socket.on('all_messages', messagesHandler );
			};
		
		</script>
    </head>
    <body>
		<div id="messages">
			
		</div>
		<div>
			<input type="text" value="" id="user_message"/>
			<button id="send_btn">Envoyer</button>
		</div>
    </body>
</html>